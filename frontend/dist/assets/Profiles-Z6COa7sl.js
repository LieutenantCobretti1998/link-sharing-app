import{g as f,f as l,V as p}from"./index-CO1j_CrX.js";const i=p,w=async s=>{const e=await fetch(`${i}/create_profile`,{method:"POST",body:JSON.stringify({new_profile_name:s}),headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f()},credentials:"include"}),r=await e.json();if(!e.ok){if(e.status===401)if(await l()){const n=await fetch(`${i}/create_profile`,{method:"POST",body:JSON.stringify({new_profile_name:s}),headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f()},credentials:"include"}),o=await n.json();if(!n.ok){const a=(o==null?void 0:o.message)||"Error fetching links after token refresh.";throw new Error(a)}return o}else throw new Error("Session expired. Please log in again.");throw new Error(r.message)}return r},E=async()=>{const s=await fetch(`${i}/related-profiles`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),e=await s.json();if(!s.ok){if(s.status===401)if(await l()){const t=await fetch(`${i}/related-profiles`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),n=await t.json();if(!t.ok){const o=(n==null?void 0:n.message)||"Error fetching links after token refresh.";throw new Error(o)}return n}else throw new Error("Session expired. Please log in again.");throw new Error(e.message)}return e},g=async s=>{const e=await fetch(`${i}/choose_profile/${s}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),r=await e.json();if(!e.ok){if(e.status===401)if(await l()){const n=await fetch(`${i}/choose_profile/${s}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),o=await n.json();if(!n.ok){const a=(o==null?void 0:o.message)||"Error fetching links after token refresh.";throw new Error(a)}return o}else throw new Error("Session expired. Please log in again.");throw new Error(r.message)}return r},m=async s=>{const e=localStorage.getItem("current-profile"),r=JSON.parse(e);if(!r)throw new Error("Profile is missed!");const t=await fetch(`${i}/change-profile-name/${r.profile_id}/${r.profile_name}`,{method:"PATCH",body:JSON.stringify({new_profile_name:s}),headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f()},credentials:"include"}),n=await t.json();if(!t.ok){if(t.status===401)if(await l()){const a=await fetch(`${i}/change-profile-name/${r.profile_id}/${r.profile_name}`,{method:"PATCH",body:JSON.stringify({new_profile_name:s}),headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f()},credentials:"include"}),c=await a.json();if(!a.ok){const d=(c==null?void 0:c.error)||"Error fetching links after token refresh.";throw new Error(d)}return c}else throw new Error("Session expired. Please log in again.");throw new Error(n.error)}return n},u=async()=>{const s=localStorage.getItem("current-profile"),e=JSON.parse(s);if(!e)throw new Error("Profile is missed!");const r=await fetch(`${i}/delete-profile/${e.profile_id}/${e.profile_name}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":f()},credentials:"include"}),t=await r.json();if(!r.ok){if(r.status===401)if(await l()){const o=await fetch(`${i}/delete-profile/${e.profile_id}/${e.profile_name}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":f()},credentials:"include"}),a=await o.json();if(!o.ok){const c=(a==null?void 0:a.error)||"Error fetching links after token refresh.";throw new Error(c)}return a}else throw new Error("Session expired. Please log in again.");throw new Error(t.error)}return t};export{E as a,w as b,g as c,u as d,m as u};
